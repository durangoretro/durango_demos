; -- Constants --
VIDEO_MODE = $df80
HIRES = $80
INVERT = $40
SCREEN_0 = $00
SCREEN_1 = $10
SCREEN_2 = $20
SCREEN_3 = $30
RGB = $08
LED = $04
SERIAL_PORT = $df93
SERIAL_HEX = $00
SERIAL_ASCII = $01
SERIAL_BINARY = $02
SERIAL_DUMP = $fd
SERIAL_STACK = $fe
SERIAL_STAT = $ff
CONTROLLER_1 = $df9c
CONTROLLER_2 = $df9d
BUTTON_A = $80
BUTTON_START = $40
BUTTON_B = $20
BUTTON_SELECT = $10
BUTTON_UP = $08
BUTTON_LEFT = $04
BUTTON_DOWN = $02
BUTTON_RIGHT = $01
NEGRO = $00
VERDE = $11
ROJO = $22
NARANJA = $33
BOTELLA = $44
LIMA = $55
LADRILLO = $66
AMARILLO = $77
AZUL = $88
CELESTE = $99
MAGENTA = $aa
ROSITA = $bb
AZUR = $cc
CIAN = $dd
FUCSIA = $ee
BLANCO = $ff
; -- Functions args pointers --
VMEM_POINTER = $10 ; $11
TILE_TO_DRAW = $12 ; $13
MAP_TO_DRAW = $14 ; 15
X_COORD = $16
Y_COORD = $17
SQ_WIDTH = $18
SQ_HEIGHT = $19
DRAW_BUFFER = $1a
CURRENT_COLOR = $1b
TEMP1 = $1c
TEMP2 = $1d



*=$c000
begin:

; Set video mode
; [HiRes Invert S1 S0    RGB LED NC NC]
LDA #$3c
STA $df80

LDA #SERIAL_HEX
STA SERIAL_PORT+1

; [08][07][06][05][04][03][02][01]
.(
LDY #08
loop:
STY SERIAL_PORT
DEY
BNE loop
.)

LDA #SERIAL_ASCII
STA SERIAL_PORT+1
LDA #$0a
STA SERIAL_PORT

LDA #SERIAL_HEX
STA SERIAL_PORT+1

; [07][06][05][04][03][02][01][00]
.(
LDY #08
DEY
loop:
STY SERIAL_PORT
DEY
BPL loop
.)

end: JMP end


debug:
.(
    PHA
    LDA #SERIAL_HEX
    STA SERIAL_PORT+1
    LDA VMEM_POINTER+1
    STA SERIAL_PORT
    LDA VMEM_POINTER
    STA SERIAL_PORT
    PLA
    RTS
.)

debug2:
.(
    PHA
    LDA #SERIAL_HEX
    STA SERIAL_PORT+1
    LDA VMEM_POINTER+1
    STA SERIAL_PORT
    LDA VMEM_POINTER
    STA SERIAL_PORT
    PLA
    RTS
.)

debug3:
.(
    PHA
    LDA #SERIAL_HEX
    STA SERIAL_PORT+1
    LDA X_COORD
    STA SERIAL_PORT
    LDA Y_COORD
    STA SERIAL_PORT
    PLA
    RTS
.)

.dsb    $fffa-*, $ff    ; filling
* = $fffa
    .word begin
    .word begin
    .word begin
